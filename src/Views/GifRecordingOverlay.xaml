<Window x:Class="SnipIt.Views.GifRecordingOverlay"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="GIF Recording"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        WindowState="Normal"
        Cursor="Cross"
        KeyDown="Window_KeyDown">

    <Grid x:Name="MainGrid">
        <!-- Background overlay with screenshot (for region selection) -->
        <Image x:Name="BackgroundImage" Stretch="Fill"/>

        <!-- Dark overlay (for region selection) -->
        <Canvas x:Name="OverlayCanvas" Background="#80000000"
                MouseLeftButtonDown="Canvas_MouseLeftButtonDown"
                MouseMove="Canvas_MouseMove"
                MouseLeftButtonUp="Canvas_MouseLeftButtonUp">
        </Canvas>

        <!-- Info panel (size during selection) -->
        <Border x:Name="InfoPanel"
                Background="#DD000000"
                CornerRadius="4"
                Padding="10,6"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="10"
                IsHitTestVisible="False">
            <StackPanel Orientation="Horizontal">
                <TextBlock x:Name="SizeText" Foreground="White" FontFamily="Consolas" FontSize="12"/>
            </StackPanel>
        </Border>

        <!-- Help text (selection phase) -->
        <Border x:Name="SelectionHelpPanel" Background="#AA000000" CornerRadius="4" Padding="12,8"
                HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,30"
                IsHitTestVisible="False">
            <TextBlock Foreground="White" FontSize="12" TextAlignment="Center">
                <Run Text="GIF 녹화할 영역을 선택하세요"/>
                <LineBreak/>
                <Run Text="ESC 취소 | 드래그로 영역 선택"/>
            </TextBlock>
        </Border>

        <!-- Countdown banner (after selection) - positioned via code -->
        <Border x:Name="CountdownPanel"
                Visibility="Collapsed"
                Background="#EE000000"
                CornerRadius="0,0,12,12"
                Padding="30,15"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                IsHitTestVisible="False">
            <StackPanel Orientation="Horizontal">
                <TextBlock x:Name="CountdownText"
                           Text="3"
                           Foreground="#FF5252"
                           FontSize="48"
                           FontWeight="Bold"
                           VerticalAlignment="Center"/>
                <TextBlock Text="초 후 녹화 시작"
                           Foreground="White"
                           FontSize="20"
                           VerticalAlignment="Center"
                           Margin="15,0,0,0"/>
            </StackPanel>
        </Border>

        <!-- Recording indicator (during recording) -->
        <Border x:Name="RecordingPanel"
                Visibility="Collapsed"
                Background="#DD000000"
                CornerRadius="8"
                Padding="15,10"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Margin="0,20,0,0"
                IsHitTestVisible="False">
            <StackPanel Orientation="Horizontal">
                <Ellipse x:Name="RecordingDot" Width="12" Height="12" Fill="Red" Margin="0,0,10,0"/>
                <TextBlock x:Name="RecordingTimeText"
                           Text="REC 00:00"
                           Foreground="White"
                           FontFamily="Consolas"
                           FontSize="16"
                           FontWeight="Bold"
                           VerticalAlignment="Center"/>
                <Border Background="#FF5252"
                        CornerRadius="4"
                        Margin="20,0,0,0"
                        Cursor="Hand"
                        MouseLeftButtonDown="StopButton_Click">
                    <TextBlock Text="■ 녹화 종료"
                               Foreground="White"
                               FontSize="13"
                               FontWeight="Bold"
                               Padding="12,4"
                               VerticalAlignment="Center"/>
                </Border>
            </StackPanel>
        </Border>

        <!-- Recording region border -->
        <Border x:Name="RecordingBorder"
                Visibility="Collapsed"
                BorderBrush="Red"
                BorderThickness="3"
                Background="Transparent"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"/>

        <!-- Magnifier (follows mouse during selection) -->
        <Border x:Name="Magnifier"
                Width="120" Height="120"
                BorderBrush="#FF5252" BorderThickness="2"
                Visibility="Collapsed"
                HorizontalAlignment="Left" VerticalAlignment="Top"
                IsHitTestVisible="False">
            <Grid>
                <Image x:Name="MagnifierImage" Stretch="None" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                <Line X1="60" Y1="0" X2="60" Y2="120" Stroke="#80FFFFFF" StrokeThickness="1"/>
                <Line X1="0" Y1="60" X2="120" Y2="60" Stroke="#80FFFFFF" StrokeThickness="1"/>
            </Grid>
        </Border>
    </Grid>
</Window>
